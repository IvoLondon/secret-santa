// Fisher-Yates (aka Knuth) Shuffle.
const shuffler = (people) => {
  const newArrPeople = [...people];
  let currentIndex = people.length,
    randomIndex;

  // While there remain elements to shuffle.
  while (currentIndex !== 0) {
    // Pick a remaining element.
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;

    // And swap it with the current element.
    [newArrPeople[currentIndex], newArrPeople[randomIndex]] = [
      newArrPeople[randomIndex],
      newArrPeople[currentIndex],
    ];
  }

  return newArrPeople;
};


const secretSantaMatcher = (people) => {
  // Shuffle array
  const shuffledArray = shuffler(people);

  // Matches
  const matches = new Set();
  shuffledArray.forEach((user, index) => {
    // Last in the array is assigned to first in the array
    if (index >= shuffledArray.length - 1) {
      matches.add([user, shuffledArray[0]]);
    } else {
      matches.add([user, shuffledArray[index + 1]]);
    }
    return user;
  });

  // returns a Set
  return matches;
};

module.exports = secretSantaMatcher;
